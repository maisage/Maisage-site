<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Facility Insights dashboard | Maisage</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-white text-slate-900">

  <!-- Shared Header -->
  <div id="site-header"></div>
  <script>
    fetch('header.html')
      .then(r => r.text())
      .then(html => (document.getElementById('site-header').innerHTML = html))
      .catch(err => console.error("Header failed to load:", err));
  </script>

  <!-- Breadcrumb: Home / Facility Insights / Facility Insights dashboard -->
  <script>
    window.breadcrumbParentLabel = "Facility Insights";
    window.breadcrumbParentHref = "facility-insights.html";
    window.breadcrumbCurrent = "Facility Insights dashboard";
  </script>
  <div id="breadcrumb"></div>
  <script>
    fetch('breadcrumb.html')
      .then(r => r.text())
      .then(html => {
        const el = document.getElementById('breadcrumb');
        if (el) el.innerHTML = html;
      })
      .catch(err => console.error("Breadcrumb failed to load:", err));
  </script>

  <!-- Main content -->
  <main class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-6 sm:py-8 space-y-10">

    <!-- Hero / Intro -->
    <section class="space-y-4 max-w-3xl">
      <p class="text-sm uppercase tracking-wide text-emerald-700 font-medium">
        Facility Insights dashboard
      </p>
      <h1 class="text-2xl sm:text-3xl font-bold text-slate-900">
        Facility Insights dashboard â€“ facilities near you
      </h1>
      <p class="text-sm sm:text-base text-slate-700">
        This page lays out how Maisage can organize facilities in your area using public data â€” inspections,
        staffing, complaints, enforcement actions, and ownership stability â€” so you can decide where to look
        closer and what to ask when you visit.
      </p>
      <p class="text-[11px] sm:text-xs text-slate-500">
        The table below is powered by <code>facility-sample.json</code> in this repository. In a live version,
        each row would reflect up-to-date CMS and state data with clear source dates.
      </p>
    </section>

    <!-- Filters (static for now) -->
    <section class="space-y-3">
      <h2 class="text-lg sm:text-xl font-semibold text-slate-900">
        Filter facilities by area and type
      </h2>
      <p class="text-xs sm:text-sm text-slate-700 max-w-3xl">
        These filters show how you might narrow the search around your ZIP code and needs. In this mock layout,
        they donâ€™t yet change the sample table â€” theyâ€™re here to show how filtering could work.
      </p>

      <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-4 sm:p-5 space-y-3 text-xs sm:text-sm">
        <div class="grid gap-4 sm:grid-cols-4">
          <div class="space-y-1">
            <label class="block font-medium text-slate-800">ZIP code</label>
            <input
              type="text"
              inputmode="numeric"
              placeholder="e.g., 77008"
              class="w-full rounded-md border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-emerald-600"
            />
          </div>
          <div class="space-y-1">
            <label class="block font-medium text-slate-800">Radius</label>
            <select class="w-full rounded-md border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-emerald-600">
              <option>10 miles</option>
              <option>25 miles</option>
              <option>50 miles</option>
              <option>State-wide</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="block font-medium text-slate-800">Facility type</label>
            <select class="w-full rounded-md border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-emerald-600">
              <option>All types</option>
              <option>Nursing facility (NF/SNF)</option>
              <option>Assisted living</option>
              <option>Memory care</option>
              <option>Inpatient rehab</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="block font-medium text-slate-800">Payer mix focus</label>
            <select class="w-full rounded-md border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-emerald-600">
              <option>Any mix</option>
              <option>High Medicaid %</option>
              <option>Mostly private pay</option>
              <option>Mixed payer types</option>
            </select>
          </div>
        </div>
        <p class="text-[11px] text-slate-500">
          In a future implementation, these filters can drive real queries on the JSON-backed dataset or external feeds.
        </p>
      </div>
    </section>

    <!-- Safety Pulse legend -->
    <section class="space-y-2 max-w-3xl">
      <h2 class="text-lg sm:text-xl font-semibold text-slate-900">
        Safety Pulse â€“ quick color guide
      </h2>
      <p class="text-xs sm:text-sm text-slate-700">
        Each facility row includes a Safety Pulse indicator. It summarizes patterns in public data and is meant to
        guide where you look closer â€” not to make the decision for you.
      </p>
      <div class="grid gap-3 sm:grid-cols-3 text-xs sm:text-sm">
        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-3 space-y-1">
          <p class="font-semibold text-slate-900">ðŸŸ© Generally stable</p>
          <p class="text-slate-700">No unusual patterns in inspections, staffing, or enforcement.</p>
        </div>
        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-3 space-y-1">
          <p class="font-semibold text-slate-900">ðŸŸ¨ Mixed signals</p>
          <p class="text-slate-700">Some signals suggest a closer look, like repeat citations or staffing dips.</p>
        </div>
        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm p-3 space-y-1">
          <p class="font-semibold text-slate-900">ðŸŸ¥ Elevated concern</p>
          <p class="text-slate-700">Recent or repeated issues; deserves careful review and specific questions.</p>
        </div>
      </div>
    </section>

    <!-- Facility list table (JSON-driven) -->
    <section class="space-y-3">
      <h2 class="text-lg sm:text-xl font-semibold text-slate-900">
        Facilities in your current view
      </h2>
      <p class="text-xs sm:text-sm text-slate-700 max-w-3xl">
        These rows are generated from <code>facility-sample.json</code>. As you refine that data file, this table
        will update automatically without editing the HTML.
      </p>

      <div class="overflow-x-auto rounded-2xl border border-slate-200 bg-white shadow-sm">
        <table class="min-w-full text-xs sm:text-sm">
          <thead class="bg-slate-50 text-slate-700">
            <tr>
              <th class="px-3 py-2 text-left font-medium">Facility</th>
              <th class="px-3 py-2 text-left font-medium">City</th>
              <th class="px-3 py-2 text-left font-medium">Type</th>
              <th class="px-3 py-2 text-right font-medium">Beds</th>
              <th class="px-3 py-2 text-right font-medium">% Medicaid</th>
              <th class="px-3 py-2 text-left font-medium">Last inspection</th>
              <th class="px-3 py-2 text-left font-medium">Safety Pulse</th>
              <th class="px-3 py-2 text-right font-medium">Details</th>
            </tr>
          </thead>
          <tbody id="facility-rows" class="divide-y divide-slate-100">
            <!-- JavaScript will inject rows here -->
          </tbody>
        </table>
      </div>

      <p id="facility-error" class="text-[11px] text-red-600 hidden">
        There was a problem loading the facility data. Please check the JSON file name, path, or format.
      </p>

      <p class="text-[11px] sm:text-xs text-slate-500 max-w-3xl">
        In a more advanced version, each detail link can point to a facility-specific page built from the same JSON
        (using <code>facility-detail-template.html</code>) so you donâ€™t have to copy content by hand.
      </p>
    </section>

    <!-- Light inline CTA -->
    <p class="text-center text-xs sm:text-sm text-slate-600 mt-8">
      Need help making sense of these patterns for your own situation?
      <a href="start-here.html" class="text-emerald-700 hover:underline">Start Here</a>
      or
      <a href="contact.html" class="text-emerald-700 hover:underline">contact Maisage</a>.
    </p>

  </main>

  <!-- Shared Footer -->
  <div id="site-footer"></div>
  <script>
    fetch('footer.html')
      .then(r => r.text())
      .then(html => (document.getElementById('site-footer').innerHTML = html))
      .catch(err => console.error("Footer failed to load:", err));
  </script>

  <!-- JavaScript: load JSON and build table -->
  <script>
    async function loadFacilities() {
      const tbody = document.getElementById('facility-rows');
      const errorEl = document.getElementById('facility-error');

      try {
        // Must match your JSON filename exactly:
        const res = await fetch('facility-sample.json');
        if (!res.ok) throw new Error('HTTP ' + res.status);

        const facilities = await res.json();
        tbody.innerHTML = '';

        facilities.forEach(fac => {
          const tr = document.createElement('tr');
          tr.className = 'hover:bg-slate-50';

          let safetyLabel = '';
          let badgeClass = '';

          if (fac.safetyPulse === 'green') {
            safetyLabel = 'ðŸŸ© Generally stable';
            badgeClass = 'bg-emerald-50 text-emerald-800';
          } else if (fac.safetyPulse === 'yellow') {
            safetyLabel = 'ðŸŸ¨ Mixed signals';
            badgeClass = 'bg-amber-50 text-amber-800';
          } else if (fac.safetyPulse === 'red') {
            safetyLabel = 'ðŸŸ¥ Elevated concern';
            badgeClass = 'bg-rose-50 text-rose-800';
          } else {
            safetyLabel = 'Pattern not set';
            badgeClass = 'bg-slate-50 text-slate-700';
          }

          tr.innerHTML = `
            <td class="px-3 py-3 align-top">
              <div class="font-semibold text-slate-900">${fac.name}</div>
            </td>
            <td class="px-3 py-3 align-top">
              ${fac.city}, ${fac.state}
            </td>
            <td class="px-3 py-3 align-top">
              ${fac.type}
            </td>
            <td class="px-3 py-3 align-top text-right">
              ${fac.beds}
            </td>
            <td class="px-3 py-3 align-top text-right">
              ${fac.medicaidPercent}%
            </td>
            <td class="px-3 py-3 align-top">
              ${fac.lastInspection}
            </td>
            <td class="px-3 py-3 align-top">
              <div class="inline-flex flex-col gap-0.5">
                <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium ${badgeClass}">
                  ${safetyLabel}
                </span>
                <span class="text-[11px] text-slate-600">
                  ${fac.safetyNote || ''}
                </span>
              </div>
            </td>
            <td class="px-3 py-3 align-top text-right">
              <a href="facility-detail-template.html" class="text-emerald-700 hover:underline text-xs sm:text-sm">
                View details &rarr;
              </a>
            </td>
          `;

          tbody.appendChild(tr);
        });

      } catch (err) {
        console.error('Error loading facilities:', err);
        if (errorEl) errorEl.classList.remove('hidden');
      }
    }

    loadFacilities();
  </script>
<!-- Floating Feedback Link -->
<a href="feedback.html"
   class="fixed right-2 bottom-4 sm:right-4 sm:bottom-6 shadow-lg
          bg-emerald-600 hover:bg-emerald-700 text-white
          px-3 py-2 rounded-full text-xs sm:text-sm font-medium">
  Give Feedback
</a>
</body>
</html>
